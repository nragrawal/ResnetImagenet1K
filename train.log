----------------------------------------------------------------------------------------------------
Training of g4dn.2xlarge instance with 1 GPU and no mixed precision training
Epoch Time : 3 hrs.
Instance : g4dn.2xlarge. 1 NVIDIA T4 GPU with 16GB memory
----------------------------------------------------------------------------------------------------

Number of training samples: 128079
Number of validation samples: 5000
Training on cuda
Number of classes: 100
Logging to: outputs/training_log_20241227_034354.txt

Epoch 1/30:
Train Loss: 4.6086 Acc: 2.02%
Val Loss: 4.2807 Acc: 4.32%
New best accuracy: 4.32%

Epoch 2/30:
Train Loss: 4.1532 Acc: 6.16%
Val Loss: 3.8793 Acc: 10.58%
New best accuracy: 10.58%

Epoch 3/30:
Train Loss: 3.7536 Acc: 12.39%
Val Loss: 3.5632 Acc: 17.76%
New best accuracy: 17.76%

Epoch 4/30:
Train Loss: 3.3157 Acc: 20.29%
Val Loss: 3.0855 Acc: 26.74%
New best accuracy: 26.74%

Epoch 5/30:
Train Loss: 3.0103 Acc: 26.26%
Val Loss: 2.8530 Acc: 29.82%
New best accuracy: 29.82%
Saved checkpoint to: checkpoints/checkpoint_epoch_5.pth

Epoch 6/30:
Train Loss: 2.7626 Acc: 31.58%
Val Loss: 2.4506 Acc: 38.52%
New best accuracy: 38.52%

Epoch 7/30:
Train Loss: 2.5654 Acc: 36.08%
Val Loss: 2.2507 Acc: 43.28%
New best accuracy: 43.28%

Epoch 8/30:
Train Loss: 2.3805 Acc: 40.33%
Val Loss: 2.1314 Acc: 46.20%
New best accuracy: 46.20%

Epoch 9/30:
Train Loss: 2.2383 Acc: 43.42%
Val Loss: 4.3310 Acc: 46.64%
New best accuracy: 46.64%

Epoch 10/30:
Train Loss: 2.5930 Acc: 43.33%
Val Loss: 2.4257 Acc: 44.81%
Saved checkpoint to: checkpoints/checkpoint_epoch_10.pth

Epoch 11/30:
Train Loss: 2.5446 Acc: 44.13%
Val Loss: 2.4153 Acc: 45.30%

Epoch 12/30:
Train Loss: 2.4952 Acc: 45.03%
Val Loss: 2.2019 Acc: 49.05%
New best accuracy: 49.05%

Epoch 13/30:
Train Loss: 2.4447 Acc: 45.93%
Val Loss: 2.3277 Acc: 46.83%

Epoch 14/30:
Train Loss: 2.3937 Acc: 46.89%
Val Loss: 2.1633 Acc: 49.39%
New best accuracy: 49.39%

Epoch 15/30:
Train Loss: 2.3418 Acc: 47.91%
Val Loss: 2.2056 Acc: 49.02%
Saved checkpoint to: checkpoints/checkpoint_epoch_15.pth

Epoch 16/30:
Train Loss: 2.2861 Acc: 48.97%
Val Loss: 2.0176 Acc: 52.73%
New best accuracy: 52.73%

Epoch 17/30:
Train Loss: 2.2263 Acc: 50.11%
Val Loss: 1.9583 Acc: 53.77%
New best accuracy: 53.77%

Epoch 18/30:
Train Loss: 2.1631 Acc: 51.27%
Val Loss: 1.8738 Acc: 55.67%
New best accuracy: 55.67%

Epoch 19/30:
Train Loss: 2.1001 Acc: 52.51%
Val Loss: 1.8668 Acc: 55.86%
New best accuracy: 55.86%

Epoch 20/30:
Train Loss: 2.0316 Acc: 53.88%
Val Loss: 1.7205 Acc: 58.68%
New best accuracy: 58.68%
Saved checkpoint to: checkpoints/checkpoint_epoch_20.pth

----------------------------------------------------------------------------------------------------
Switched to Mixed precision training loaded from checkpoint 15 of non mixed precision training.
Epoch Time : 45 minutes
Instance : g6e.xlarge ( 45GB GPU memory)
----------------------------------------------------------------------------------------------------

Dataset statistics:
Total classes: 1000

Training set:
Total images: 1281167
Average images per class: 1281.2
Min images in a class: 732
Max images in a class: 1300

Validation set:
Total images: 50000
Average images per class: 50.0
Min images in a class: 50
Max images in a class: 50

✓ Dataset structure verification completed successfully!
Number of training samples: 1281167
Number of validation samples: 50000

Number of training samples: 1281167
Number of validation samples: 50000
Using mixed precision training
Loading checkpoint 'checkpoints/checkpoint_epoch_15.pth'
Loaded checkpoint 'checkpoints/checkpoint_epoch_15.pth' (epoch 15)
Previous best accuracy: 49.39%
Training on cuda
Number of classes: 1000
Logging to: outputs/training_log_20241230_033323.txt

Epoch 16/100:
Train Loss: 1.7527 Acc: 59.70%
Val Loss: 1.3756 Acc: 66.05%
New best accuracy: 66.05%

Epoch 17/100:
Train Loss: 1.6189 Acc: 62.35%
Val Loss: 1.3426 Acc: 66.85%
New best accuracy: 66.85%

Epoch 18/100:
Train Loss: 1.5587 Acc: 63.57%
Val Loss: 1.3377 Acc: 66.94%
New best accuracy: 66.94%

Epoch 19/100:
Train Loss: 1.5162 Acc: 64.45%
Val Loss: 1.3070 Acc: 67.59%
New best accuracy: 67.59%

Epoch 20/100:
Train Loss: 1.4771 Acc: 65.21%
Val Loss: 1.2863 Acc: 67.96%
New best accuracy: 67.96%
Saved checkpoint to: checkpoints/checkpoint_epoch_20.pth
~                                                                                                                                                                                                           

----------------------------------------------------------------------------------------------------
Switched to Multiple GPUS Training loaded from checkpoint 20 of *non* mixed precision training:
Epoch Time : 24 minutes
Instance : g4dn.12xlarge 4 NVIDIA T4 GPUs with 16GB memory each
----------------------------------------------------------------------------------------------------
Loaded checkpoint 'cp_stored/checkpoints_no_mp_no_gpu/checkpoint_epoch_20.pth' (epoch 20)
Previous best accuracy: 58.68%
Training on cuda
Number of classes: 1000
Logging to: outputs/training_log_20241230_060457.txt
Epoch 21/100:   0%|                                                                                                                                                                | 0/1252 [00:00<?, ?it/s]
/home/ubuntu/train_resnet_checkpount_mp_mgpu_new.py:213: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with self.autocast():
Epoch 21/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1252/1252 [23:30<00:00,  1.13s/it, loss=1.5991, acc=62.83%]
Validating:   0%|                                                                                                                                                                    | 0/49 [00:00<?, ?it/s]
/home/ubuntu/train_resnet_checkpount_mp_mgpu_new.py:245: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.no_grad(), self.autocast():
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [01:01<00:00,  1.26s/it, loss=1.2687, acc=68.58%]

Epoch 21/100:
Train Loss: 1.5991 Acc: 62.83%
Val Loss: 1.2687 Acc: 68.58%
New best accuracy: 68.58%
Saved checkpoint to: checkpoints/checkpoint_epoch_021.pth
Saved best model to: checkpoints/model_best.pth
Epoch 22/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1252/1252 [23:10<00:00,  1.11s/it, loss=1.4956, acc=64.96%]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:33<00:00,  1.46it/s, loss=1.2262, acc=69.56%]

Epoch 22/100:
Train Loss: 1.4956 Acc: 64.96%
Val Loss: 1.2262 Acc: 69.56%
New best accuracy: 69.56%
Saved checkpoint to: checkpoints/checkpoint_epoch_022.pth
Saved best model to: checkpoints/model_best.pth
Epoch 23/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1252/1252 [23:12<00:00,  1.11s/it, loss=1.4499, acc=65.91%]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:59<00:00,  1.22s/it, loss=1.2018, acc=70.04%]

Epoch 23/100:
Train Loss: 1.4499 Acc: 65.91%
Val Loss: 1.2018 Acc: 70.04%
New best accuracy: 70.04%
Saved checkpoint to: checkpoints/checkpoint_epoch_023.pth
Saved best model to: checkpoints/model_best.pth
Epoch 24/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1252/1252 [23:11<00:00,  1.11s/it, loss=1.4135, acc=66.72%]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:57<00:00,  1.17s/it, loss=1.1753, acc=70.64%]

Epoch 24/100:
Train Loss: 1.4135 Acc: 66.72%
Val Loss: 1.1753 Acc: 70.64%
New best accuracy: 70.64%
Saved checkpoint to: checkpoints/checkpoint_epoch_024.pth
Saved best model to: checkpoints/model_best.pth
Epoch 25/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1252/1252 [23:12<00:00,  1.11s/it, loss=1.3871, acc=67.28%]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:33<00:00,  1.47it/s, loss=1.1656, acc=70.82%]

Epoch 25/100:
Train Loss: 1.3871 Acc: 67.28%
Val Loss: 1.1656 Acc: 70.82%
New best accuracy: 70.82%
Saved checkpoint to: checkpoints/checkpoint_epoch_025.pth
Saved best model to: checkpoints/model_best.pth
Epoch 26/100:  78%|█████████████████████████████████████████████████████████████████████████████████████████████████▉                           | 981/1252 [18:13<04:58,  1.10s/it, loss=1.3673, acc=67.72%]
Epoch 26/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1252/1252 [23:11<00:00,  1.11s/it, loss=1.3670, acc=67.72%]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:57<00:00,  1.17s/it, loss=1.1434, acc=71.33%]

Epoch 26/100:
Train Loss: 1.3670 Acc: 67.72%
Val Loss: 1.1434 Acc: 71.33%
New best accuracy: 71.33%
Saved checkpoint to: checkpoints/checkpoint_epoch_026.pth
Saved best model to: checkpoints/model_best.pth

Epoch 28/100:
Train Loss: 1.3207 Acc: 68.67%
Val Loss: 1.1252 Acc: 71.72%
New best accuracy: 71.72%
Saved checkpoint to: checkpoints/checkpoint_epoch_028.pth
Saved best model to: checkpoints/model_best.pth
Epoch 29/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1252/1252 [45:38<00:00,  2.19s/it, loss=1.3089, acc=68.89%]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [01:40<00:00,  2.06s/it, loss=1.1226, acc=71.84%]

Epoch 29/100:
Train Loss: 1.3089 Acc: 68.89%
Val Loss: 1.1226 Acc: 71.84%
New best accuracy: 71.84%
Saved checkpoint to: checkpoints/checkpoint_epoch_029.pth
Saved best model to: checkpoints/model_best.pth
Epoch 30/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1252/1252 [45:59<00:00,  2.20s/it, loss=1.3069, acc=69.00%]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [01:40<00:00,  2.06s/it, loss=1.1214, acc=71.82%]

Epoch 30/100:
Train Loss: 1.3069 Acc: 69.00%
Val Loss: 1.1214 Acc: 71.82%
Saved checkpoint to: checkpoints/checkpoint_epoch_030.pth
Epoch 31/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1252/1252 [45:32<00:00,  2.18s/it, loss=1.3050, acc=68.99%]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [01:40<00:00,  2.04s/it, loss=1.1210, acc=71.82%]

Epoch 31/100:
Train Loss: 1.3050 Acc: 68.99%
Val Loss: 1.1210 Acc: 71.82%
Saved checkpoint to: checkpoints/checkpoint_epoch_031.pth
Epoch 32/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1252/1252 [45:31<00:00,  2.18s/it, loss=1.3047, acc=68.98%]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [01:40<00:00,  2.06s/it, loss=1.1203, acc=71.82%]

Epoch 32/100:
Train Loss: 1.3047 Acc: 68.98%
Val Loss: 1.1203 Acc: 71.82%
Saved checkpoint to: checkpoints/checkpoint_epoch_032.pth
Epoch 33/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1252/1252 [45:43<00:00,  2.19s/it, loss=1.3039, acc=69.00%]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [01:40<00:00,  2.05s/it, loss=1.1208, acc=71.88%]

Epoch 33/100:
Train Loss: 1.3039 Acc: 69.00%
Val Loss: 1.1208 Acc: 71.88%
New best accuracy: 71.88%, Top-5: 90.55%
Saved checkpoint to: checkpoints/checkpoint_epoch_033.pth
Saved best model to: checkpoints/model_best.pth
Epoch 34/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1252/1252 [45:29<00:00,  2.18s/it, loss=1.3068, acc=68.96%]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [01:40<00:00,  2.05s/it, loss=1.1190, acc=71.87%]

----------------------------------------------------------------------------------------------------
